description: |
  <img src="images/Altimeter/altimeter_architecture_intensities.svg" alt="Altimeter intensities architecture" width="600px">
  
  **Data**  
  Source of the data: The model was trained on the ProteomeTools dataset that was re-processed in-house, including both tryptic and non-tryptic spectra. The reprocessed dataset used for training included spectra from peptides digested with trypsin, LysC, AspN, and those representing HLA class I ligands.  
  Type of molecules: The training set included synthetic peptides covering both tryptic and non-tryptic protease products, including HLA peptides.  
  Representation of molecular complexity: The dataset spans a wide variety of peptide sequences with diverse amino acid compositions and cleavage patterns, including many relevant for immunopeptidomics.  
  Data acquisition: The data was acquired using one instrument (Orbitrap Fusion Lumos), with six different collision energies (20, 23, 25, 28, 30, 35).  
  Limitations of the training data: The model was trained only on peptides containing variable methionine oxidation and static carbamidomethylation of cysteines. Other PTMs or peptides containing free cysteines were not included.  
  False positives/negatives: The training data was filtered to 1% FDR at the spectrum level. Furthermore, spectra were filtered for a minimum isolation purity of 90%, MS1 isotope cosine similarity of ≥0.95, SAGE hyperscore ≥30, and ≤3 standard deviation from the predicted RT after a spline alignment to Chronologer predictions.  

  **Optimization**  
  Optimization target: The model was trained to predict the total abundance (sum of all isotopes) of each fragment ion at specific NCEs by evaluating cubic spline functions generated by `Altimeter_2024_splines`.  
  Experimental variability: No explicit comparison to experimental variability is provided, though normalized spectral angle was used to assess agreement with observed spectra.  
  Metric: The normalized spectral angle (SA) was used as the primary performance metric to compare predicted and experimental MS2 spectra.  

  **Model**  
  Interpretability: The model evaluates cubic B-spline curves that represent the abundance of each fragment ion across an NCE range. These splines are computed by `Altimeter_2024_splines` and then evaluated at the specified NCE.  
  Model type: Regression model outputting normalized fragment ion intensities.  
  Limitations: The model is specific to HCD fragmentation on Orbitrap instruments and has only been validated in the NCE range of 20-40. It has not been formally evaluated for other fragmentation techniques or instruments, but performs well for Astral DIA analysis.  

  **Evaluation**  
  Performance measures: The primary evaluation metric was the normalized spectral angle between predicted and observed spectra.  
  Choice of performance measures: Spectral angle was chosen because it is sensitive to overall spectral similarity and reflects prediction accuracy well across different peptides.  
  Single number performance: The model achieved a median normalized spectral angle of 0.941 on the test set.  
  Comparison to baseline methods: Performance is comparable to existing models like Prosit, though no direct comparison was made.  
  Evaluation methods: The dataset was split at the peptide level into 70% training, 20% validation, and 10% testing. The model was evaluated on the test set and benchmarked across diverse peptide types.  
  Model performance variability: The model shows consistent accuracy across different protease types and peptide lengths. Performance degrades slightly for long peptides and extreme precursor charges.  
  Data applicability: The model is applicable to tryptic and non-tryptic peptides with standard modifications (oxM, carbamidomethyl C) and NCE values within 20-40. It is not suitable for spectra acquired under other fragmentation methods or outside this NCE range.  

  **Input notes**  
  <ul> <li>Length: 6-40 amino acids (6-30 recommended).</li> <li>Charge: 1-7 (1-4 recommended).</li> <li>PTMs: Variable oxidation of methionine (M[UNIMOD:35]), static carbamidomethylation of cysteine (C[UNIMOD:4]).</li> <li>NCE: Any value in the range 20-40.</li> </ul>
  **Output notes**  
  <ul> <li>Altimeter evaluates cubic B-spline functions predicted by <code>Altimeter_2024_splines</code> to compute fragment intensities at a requested NCE.</li> <li>Intensities are normalized by the base peak (i.e., the most intense fragment) for each predicted spectrum.</li> <li>Only the top 200 fragments (by predicted intensity) are returned per peptide.</li> <li>The model includes prediction of precursor ions and immonium ions. Annotations follow the <a target="_blank" href="https://www.psidev.info/mzPAF">mzPAF</a> specification.</li>  </ul>
citation: |
    BioRxiv coming soon.

tag: "Fragment Intensity"
examples:
  inputs:
    [
      {
          "name": "peptide_sequences",
          "httpdtype": "BYTES",
          "shape": "[2,1]",
          "data": '["AAAAAKAK", "AC[UNIMOD:4]DEFGHIKLM[UNIMOD:35]NPQRSTVWY"]'
      },
      {
          "name": "precursor_charges",
          "httpdtype": "INT32",
          "shape": "[2,1]",
          "data": '[1,2]'
      },
      {
          "name": "collision_energies",
          "httpdtype": "FP32",
          "shape": "[2,1]",
          "data": '[25, 25]'
      }
    ]
